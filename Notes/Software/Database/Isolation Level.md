 ุงู ูุดฺฉูุงุช ุฏุฑ ุฏุชุงุจุณ ููุช ุงุชูุงู ูโุงูุชูุฏ ฺฉู ุชุฑุงฺฉูุดโูุง ููุฒูุงู ุฑู ุฏุงุฏูโูุง ฺฉุณุงู ุชุฃุซุฑ ุจฺฏุฐุงุฑูุฏ ู ุงุฒูููโุณุงุฒ ุจู ุงูุฏุงุฒู ฺฉุงู ูู ูุจุงุดุฏ.

---

### ๐ ุงDirty Read (ุฎูุงูุฏู ฺฉุซู)

๐น ุฒูุงู ุงุชูุงู ูโุงูุชุฏ ฺฉู ฺฉ ุชุฑุงฺฉูุด ุฏุงุฏูโุง ุฑุง ุจุฎูุงูุฏ ฺฉู ูููุฒ ุฏุฑ ฺฉ ุชุฑุงฺฉูุด ุฏฺฏุฑ **Commit ูุดุฏู** ุงุณุช. ุงฺฏุฑ ุชุฑุงฺฉูุด ุฏูู **Rollback ุดูุฏ**ุ ุฏุงุฏูโุง ฺฉู ุชุฑุงฺฉูุด ุงูู ุฎูุงูุฏู ุจูุฏ ุฏฺฏุฑ ูุนุชุจุฑ ูุฎูุงูุฏ ุจูุฏ.

โ **ูุซุงู:**

1. ุชุฑุงฺฉูุด `T1` ููุฏุงุฑ `balance` ุฑุง ุงุฒ 100 ุจู 200 ุชุบุฑ ูโุฏูุฏ ูู ูููุฒ `COMMIT` ูฺฉุฑุฏู ุงุณุช.
2. ุชุฑุงฺฉูุด `T2` ููุฏุงุฑ `balance` ุฑุง ุจูโุนููุงู 200 ูโุฎูุงูุฏ.
3. ุชุฑุงฺฉูุด `T1` ุนููุงุช ุฑุง `ROLLBACK` ูโฺฉูุฏ ู ููุฏุงุฑ `balance` ุจู 100 ุจุฑูโฺฏุฑุฏุฏ.
4. ุญุงูุง ุชุฑุงฺฉูุด `T2` ููุฏุงุฑ ุฎูุงูุฏู ฺฉู **ูฺโููุช ุชุฃุฏ ูุดุฏู ุจูุฏ**!

๐ **ุฑุงูโุญู:** ุณุทุญ ุงุฒูููโุณุงุฒ **Read Committed** ุง ุจุงูุงุชุฑ ุงู ูุดฺฉู ุฑุง ุญู ูโฺฉูุฏ.

---

### ๐ ุงNon-repeatable Read (ุฎูุงูุฏู ุบุฑูุงุจู ุชฺฉุฑุงุฑ)

๐น ุฒูุงู ุฑุฎ ูโุฏูุฏ ฺฉู ฺฉ ุชุฑุงฺฉูุด **ุฏู ุจุงุฑ ฺฉ ุฏุงุฏู ุฑุง ุจุฎูุงูุฏ**ุ ูู ุจู ุงู ุฏู ุฎูุงูุฏูุ ุชุฑุงฺฉูุด ุฏฺฏุฑ ููุฏุงุฑ ุฑุง ุชุบุฑ ุฏูุฏ. ุงู ุจุงุนุซ ูโุดูุฏ ฺฉู ููุฏุงุฑ ุฎูุงูุฏูโุดุฏู ุฏุฑ ูุฑ ุจุงุฑ ูุชูุงูุช ุจุงุดุฏ.

โ **ูุซุงู:**

1. ุชุฑุงฺฉูุด `T1` ููุฏุงุฑ `balance` ุฑุง ูโุฎูุงูุฏ (ูุซูุงู 100).
2. ุชุฑุงฺฉูุด `T2` ููุฏุงุฑ `balance` ุฑุง ุจู 200 ุชุบุฑ ูโุฏูุฏ ู `COMMIT` ูโฺฉูุฏ.
3. ุฏูุจุงุฑู ุชุฑุงฺฉูุด `T1` ููุฏุงุฑ `balance` ุฑุง ูโุฎูุงูุฏ ู ุงู ุจุงุฑ 200 ุงุณุช!
๐ **ุฑุงูโุญู:** ุชููุง ุณุทุญ ุงุฒูููโุณุงุฒ **Serializable** ูโุชูุงูุฏ ุงุฒ Phantom Read ุฌููฺฏุฑ ฺฉูุฏ.
ูุนูููุง ฺฉูุฆุฑ ุฏููุง ุฏุฑ ูุงูุจ ฺฉ aggergate function ูุณุชุด
~~~ sql
begin tx1,tx2
select PID from sales
// tx2 finished
select sum (qnt) from sales
~~~


---

### ๐ปุง Phantom Read 

๐น ููุช ฺฉ ุชุฑุงฺฉูุด ฺูุฏู ุจุงุฑ ฺฉ **ูุฌููุนูโุง ุงุฒ ุฏุงุฏูโูุง** ุฑุง ุจุฎูุงูุฏุ ุงูุง ุจู ุฏู ุฎูุงูุฏูุ ุชุฑุงฺฉูุด ุฏฺฏุฑ ุณุทุฑ ุฑุง **ุงุถุงูู ุง ุญุฐู ฺฉูุฏ**. ุฏุฑ ูุชุฌูุ ุชุฑุงฺฉูุด ุงูู ูุชุงุฌ ูุฎุชูู ุฏุฑุงูุช ูโฺฉูุฏ.

โ **ูุซุงู:**

4. ุชุฑุงฺฉูุด `T1` ููู ฺฉุงุฑุจุฑุงู ฺฉู `age > 18` ุฏุงุฑูุฏ ุฑุง ูโุฎูุงูุฏ (ูุซูุงู 5 ููุฑ).
5. ููโุฒูุงู ุชุฑุงฺฉูุด `T2` ฺฉ ฺฉุงุฑุจุฑ ุฌุฏุฏ ุจุง `age = 25` ุงุถุงูู ูโฺฉูุฏ ู `COMMIT` ูโฺฉูุฏ.
6. ุชุฑุงฺฉูุด `T1` ุฏูุจุงุฑู ููุงู ฺฉูุฆุฑ ุฑุง ุงุฌุฑุง ูโฺฉูุฏุ ุงูุง ุงู ุจุงุฑ **6 ฺฉุงุฑุจุฑ** ุจุฑูโฺฏุฑุฏุฏ!

๐ **ุฑุงูโุญู:** ุชููุง ุณุทุญ ุงุฒูููโุณุงุฒ **Serializable** ูโุชูุงูุฏ ุงุฒ Phantom Read ุฌููฺฏุฑ ฺฉูุฏ. ุงูุจุชู ุชู ูพุณุช ฺฏุฑุณ ูููู ุณุทุญ repeatable read  ูู ุฌููุด ุฑู ูุชููู ุจฺฏุฑู ฺูู ุฏุฑ ุงุจุชุฏุง tx ู ุงุณููพ ุดุงุช ูฺฏุฑู

### ๐ฅ ุง Lost Update
๐นุง **Lost Update** ุฒูุงู ุฑุฎ ูโุฏูุฏ ฺฉู ุฏู ุชุฑุงฺฉูุด ุชูุฑุจุงู ููโุฒูุงู ููุฏุงุฑ ฺฉ ุฏุงุฏู ุฑุง ุจุฎูุงููุฏุ ููุฏุงุฑ ุฌุฏุฏ ูุญุงุณุจู ฺฉููุฏุ ู ุขู ุฑุง ุจููุณูุฏ. ุงูุง ููุฏุงุฑ ููุดุชู ุดุฏู ุชูุณุท ุชุฑุงฺฉูุด ุงููุ ุจุฏูู ุชูุฌู ุจู ุชุบุฑุงุชุดุ ุชูุณุท ุชุฑุงฺฉูุด ุฏูู **ุจุงุฒููุณ** ูโุดูุฏ.

---

โ **ูุซุงู:**

1. **ุชุฑุงฺฉูุด `T1`** ููุฏุงุฑ `balance` ฺฉ ุญุณุงุจ ุจุงูฺฉ ุฑุง ูโุฎูุงูุฏ (`balance = 1000`).
2. **ุชุฑุงฺฉูุด `T2`** ููโุฒูุงู ููุฏุงุฑ `balance` ุฑุง ูโุฎูุงูุฏ (`balance = 1000`).
3.ุง **`T1`** ูุจูุบ 200 ุฑุง ุงุถุงูู ูโฺฉูุฏ ู ููุฏุงุฑ ุฌุฏุฏ (`balance = 1200`) ุฑุง ุฐุฎุฑู ูโฺฉูุฏ.
1. ุง**`T2`** ูุจูุบ 300 ุฑุง ุงุถุงูู ูโฺฉูุฏุ ุงูุง ูููุฒ ููุฏุงุฑ ูุฏู (`1000`) ุฑุง ุฏุงุฑุฏุ ูพุณ ููุฏุงุฑ ุฌุฏุฏ ุฑุง **1300** ูุญุงุณุจู ฺฉุฑุฏู ู ุฐุฎุฑู ูโฺฉูุฏ.
2. ุฏุฑ ูุชุฌูุ ุชุบุฑ `T1` (ุนู ุงูุฒุงุด 200) **ุงุฒ ุจู ูโุฑูุฏ** ู ููุฏุงุฑ ููุง **1300** ุฎูุงูุฏ ุจูุฏุ ุฏุฑ ุญุงู ฺฉู ุจุงุฏ **1500** ูโุดุฏ! ๐จ

---
### ๐น ุงููุงุน ุณุทูุญ ุงุฒูููโุณุงุฒ:

1๏ธโฃ ุง**Read Uncommitted (ุฎูุงูุฏู ุชุบุฑุงุช ุชุฃุฏูุดุฏู)**

- ูพุงูโุชุฑู ุณุทุญ ุงุฒูููโุณุงุฒ
- ฺฉ ุชุฑุงฺฉูุด ูโุชูุงูุฏ ุฏุงุฏูโูุง ุชุฑุงฺฉูุดโูุง ุชุฃุฏูุดุฏู (Uncommitted) ุฏฺฏุฑ ุฑุง ุจุฎูุงูุฏ
- ุงุญุชูุงู ุจุฑูุฒ **Dirty Read**ุ **Non-repeatable Read** ู **Phantom Read** ุจุงูุง ุงุณุช
- ุณุฑุน ุงูุง ูุงุงูู

2๏ธโฃ ุง**Read Committed (ุฎูุงูุฏู ุชุบุฑุงุช ุชุฃุฏุดุฏู)**

- ุชุฑุงฺฉูุด ููุท ุฏุงุฏูโูุง ุชุฃุฏุดุฏู ุฑุง ูโุฎูุงูุฏ
- ุงุฒ **Dirty Read** ุฌููฺฏุฑ ูโฺฉูุฏ ุงูุง **Non-repeatable Read** ู **Phantom Read** ููฺฉู ุงุณุช ุงุชูุงู ุจูุชูุฏ
- ุฏุฑ ุงฺฉุซุฑ ุฏุชุงุจุณโูุง (ูุซู PostgreSQL ู SQL Server) ุจูโุนููุงู ุณุทุญ ูพุดโูุฑุถ ุงุณุชูุงุฏู ูุดู 

3๏ธโฃ ุง**Repeatable Read**

- ฺฉ ุชุฑุงฺฉูุด ุชุง ูพุงุงู ุงุฌุฑุงุ ุฏุงุฏูโูุง ฺฉู ุฎูุงูุฏู ุฑุง ููู ูโฺฉูุฏ (ุชุบุฑุงุช ุชูุณุท ุฏฺฏุฑ ุชุฑุงฺฉูุดโูุง ูุฌุงุฒ ูุณุช)
- ุงุฒ **Dirty Read** ู **Non-repeatable Read** ุฌููฺฏุฑ ูโฺฉูุฏ ุงูุง **Phantom Read** ููฺฉู ุงุณุช ุฑุฎ ุฏูุฏ
- ุฏุฑ MySQL (ุจุง InnoDB) ุงู ุณุทุญ ูพุดโูุฑุถ ุงุณุช
- ุชู ูพุณุช ฺฏุฑุณ ฺูู ุชู  ุงู ุณุทุญ ุงุฒููู ุณุงุฒ ุงูู tx ู snapshot ุงุฒ db ฺฏุฑูุชู ูุดู ุจุฎุงุทุฑ ููู ูุงูุชูู ุฑุฏ ูู ุจุง ููู ุณุทุญ ูุงุจู ุญูู

4๏ธโฃ ุง**Serializable**

- ุจุงูุงุชุฑู ุณุทุญ ุงุฒูููโุณุงุฒ
- ุชูุงู ุชุฑุงฺฉูุดโูุง ุจูโุตูุฑุช ุณุฑุงู ุงุฌุฑุง ูโุดููุฏ (ุง ุงุฒ ุทุฑู ูููโฺฏุฐุงุฑ ุง ฺฉูุชุฑู ูุณุฎู)
- ุงุฒ **Dirty Read**ุ **Non-repeatable Read** ู **Phantom Read** ุฌููฺฏุฑ ูโฺฉูุฏ
- ุงููุช ุจุงูุง ุงูุง ฺฉุงุฑุง ฺฉูุชุฑ (Concurrency ฺฉุงูุด ูพุฏุง ูโฺฉูุฏ)

ุฏุฑ PostgreSQL ู MySQL ูโุชูุงู ุณุทุญ ุงุฒูููโุณุงุฒ ุฑุง ุจุง ุฏุณุชูุฑ ุฒุฑ ุชูุธู ฺฉุฑุฏ:



`SET TRANSACTION ISOLATION LEVEL REPEATABLE READ;`

ุง

`SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;`